<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!-- create by autoCode,v1.0.0 -->
<mapper namespace="manage.NvhlBase">
	<!-- 保险订单查询 -->
	<select id="manage.NvhlBase.selectPageList"
		parameterType="net.jeeshop.services.manage.NvhlBaseVO.bean.NvhlBaseVO"
		resultType="net.jeeshop.services.manage.NvhlBaseVO.bean.NvhlBaseVO">
		select n.SerialNumber id,IFNULL(DATEDIFF(NOW(),n.TInsrncEndTm),'') expire_days, n.* from nvhlbasevo n where 1=1
		<if test="createAccount!=null and createAccount!=''">
			and createAccount=#{createAccount}
		</if>
		<if test="TInsrncEndTmStartDate!=null and TInsrncEndTmStartDate!=''">
			and TInsrncEndTm &gt;= #{TInsrncEndTmStartDate}
		</if>
		<if test="TInsrncEndTmEndDate!=null and TInsrncEndTmEndDate!=''">
			and TInsrncEndTm &lt;= #{TInsrncEndTmEndDate}
		</if>
		<if test="CProdName!=null and CProdName!=''">
			and CProdName like CONCAT('%',#{CProdName,jdbcType=VARCHAR}
			,'%' )
		</if>
		order by TInsrncEndTm 	
			limit #{offset},#{pageSize}
	</select>

	<!-- 保险订单查询分页 -->
	<select id="manage.NvhlBase.selectPageCount"
		parameterType="net.jeeshop.services.manage.NvhlBaseVO.bean.NvhlBaseVO"
		resultType="java.lang.Integer">
		select count(*) from nvhlbasevo  d where 1=1
		<if test="createAccount!=null and createAccount!=''">
			and createAccount=#{createAccount}
		</if>
		<if test="TInsrncEndTmStartDate!=null and TInsrncEndTmStartDate!=''">
			and TInsrncEndTm &gt;= #{TInsrncEndTmStartDate}
		</if>
		<if test="TInsrncEndTmEndDate!=null and TInsrncEndTmEndDate!=''">
			and TInsrncEndTm &lt;= #{TInsrncEndTmEndDate}
		</if>
		<if test="CProdName!=null and CProdName!=''">
			and CProdName like CONCAT('%',#{CProdName,jdbcType=VARCHAR}
			,'%' )
		</if>
		
	</select>
	
	<!-- 插入 基本信息 NvhlBase-->
	<insert id="manage.NvhlBase.insertNvhlBase"
		parameterType="net.jeeshop.services.manage.NvhlBaseVO.bean.NvhlBaseVO"
		useGeneratedKeys="true" keyProperty="id">
		insert into nvhlbasevo(SerialNumber,CDptCde,SysRes,CBsnsTyp,CChaType,CChaSubtype,FinTyp,CProdNo,CCiMrk,NAmtRmbExch,NAmt,NPrmRmbExch,NPrm,
         TAppTm,TInsrncBgnTm,TInsrncEndTm,CGrpMrk,EfcManualFlag,CPlyTyp,CNeedfeeFlag,ICopyNum,createAccount,createTime,CProdName)
         values(#{id},#{CDptCde},#{SysRes},#{CBsnsTyp},#{CChaType},#{CChaSubtype},#{FinTyp},#{CProdNo},#{CCiMrk},#{NAmtRmbExch},#{NAmt},#{NPrmRmbExch},#{NPrm},#{TAppTm}
  		,#{TInsrncBgnTm},#{TInsrncEndTm},#{CGrpMrk},#{EfcManualFlag},#{CPlyTyp},#{CNeedfeeFlag},#{ICopyNum},#{createAccount},#{createTime},#{CProdName})
	</insert>
	<!--插入 投保人NvhlApplicantVO  -->
	<insert id="manage.NvhlBase.insertNvhlApplication"
		parameterType="net.jeeshop.services.manage.NvhlApplicantVO.bean.NvhlApplicantVO"
		useGeneratedKeys="true" keyProperty="id">
		insert into nvhlapplicantvo(
		AppCde,AppName,ClntMrk,CertfCls,CertfCde,ClntAddr,		
		ZipCde,Email,Mobile,Country,Province,
		City,Area,Stree,CusRiskLvl,CustRiskRank		
		)
         values(
         #{AppCde},#{AppNme},#{T_ClntMrk},#{T_CertfCls},#{T_CertfCde},#{T_ClntAddr},
         #{T_ZipCde},#{T_Email},#{T_Mobile},#{T_Country},#{Province},
        #{City},#{Area},#{Stree},#{T_CusRiskLvl},#{T_CustRiskRank})
	</insert>
	<!-- 插入 被保人NvhlInsuredVO -->
	<insert id="manage.NvhlBase.insertNvhlInsured"
		parameterType="net.jeeshop.services.manage.NvhlInsuredVO.bean.NvhlInsuredVO"
		useGeneratedKeys="true" keyProperty="id">
		insert into nvhlinsuredvo(
		InsuredCde,InsuredNme,ClntMrk,CCertfCls,CCertfCde,
		ClntAddr,ZipCde,CEmail,Mobile,Country,
		Province,City,Area,Stree,CusRiskLvl,
		CustRiskRank)
         values(
         #{InsuredCde},#{InsuredNme},#{B_ClntMrk},#{B_CCertfCls},#{B_CCertfCde},
         #{B_ClntAddr},#{B_ZipCde},#{CEmail},#{Mobile},#{Country},
         #{Province},#{City},#{Area},#{Stree},#{CusRiskLvl},
         #{CustRiskRank})
	</insert>
</mapper>
