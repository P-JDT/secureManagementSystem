<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd"><!-- create by autoCode,v1.0.0 --><mapper namespace="manage.secureProduct">	<!--查询保险产品信息 -->	<select id="manage.secureProduct.selectPageList"		parameterType="net.jeeshop.services.manage.secureProduct.bean.SecureProduct"		resultType="net.jeeshop.services.manage.secureProduct.bean.SecureProduct">		select		p.id,p.name,p.currency		,p.deductible,p.amounts,p.premiums		,DATE_FORMAT(p.createtime,'%Y-%m-%d') createtime		,p.appointment,p.introduce,p.insuranceClause		,p.status		from		t_secureProduct p where 1=1 and deleteFlag=0		<if test="id!=null and id!=''">			and id=#{id}		</if>				<if test="uid!=null and uid!=''">			and p.id in (select product_id from t_user_product where			user_id=			#{uid})		</if>		<if test="status!=null and status!=''">			and status=#{status}		</if>		<if test="name!=null and name!=''">			and p.name like CONCAT('%','${name}','%' )		</if> 		<if test="startDate!=null and startDate!=''">		and createtime &gt;= #{startDate}	 	</if>	 	<if test="endDate!=null and endDate!=''">		and createtime &lt;= #{endDate}	 	</if>		order by p.createtime desc		limit #{offset},#{pageSize}	</select>	<!--按照id查询保险产品信息 -->	<select id="manage.secureProduct.selectById" parameterType="string"		resultType="net.jeeshop.services.manage.secureProduct.bean.SecureProduct">		select * from t_secureProduct where		1=1 and id=#{id}	</select>	<!--查询保险子产品信息 -->	<select id="manage.secureProduct.selectDetail" parameterType="string"		resultType="net.jeeshop.services.manage.secureProduct.bean.SecureProductDetail">		select * from t_secureProductDetail where		1=1 and pid=#{id}	</select>	<!--查询产品总数 -->	<select id="manage.secureProduct.selectPageCount"		parameterType="net.jeeshop.services.manage.secureProduct.bean.SecureProduct"		resultType="java.lang.Integer">		select count(*) from t_secureProduct p where 1=1 and deleteFlag=0		<if test="id!=null and id!=''">			and id=#{id}		</if>				<if test="uid!=null and uid!=''">			and p.id in (select product_id from t_user_product where			user_id=			#{uid})		</if>		<if test="status!=null and status!=''">			and status=#{status}		</if>		<if test="name!=null and name!=''">			and p.name like CONCAT('%','${name}','%' )		</if> 		<if test="startDate!=null and startDate!=''">		and createtime &gt;= #{startDate}	 	</if>	 	<if test="endDate!=null and endDate!=''">		and createtime &lt;= #{endDate}	 	</if>	</select>	<!--插入产品信息 -->	<insert id="manage.secureProduct.insertSecureProduct"		parameterType="net.jeeshop.services.manage.secureProduct.bean.SecureProduct"		useGeneratedKeys="true" keyProperty="id">		insert into t_secureProduct		(		status,deleteFlag		,createAccount,createTime		<if test="currency !=null and currency !=''">			,currency		</if>		<if test="deductible!=null and deductible!=''">			,deductible		</if>		<if test="amounts !=null and amounts !=''">			,amounts		</if>		<if test="premiums !=null and premiums !=''">			,premiums		</if>		<if test="appointment !=null and appointment !=''">			,appointment		</if>		<if test="introduce !=null and introduce !=''">			,introduce		</if>		<if test="insuranceClause !=null and insuranceClause !=''">			,insuranceClause		</if>		<if test="name !=null and name !=''">			,name		</if>		<if test="remark!=null and remark!=''">			,remark		</if>		)		values		(		#{status},0		,#{createAccount},now()		<if test="currency !=null and currency !=''">			,#{currency}		</if>		<if test="deductible!=null and deductible!=''">			,#{deductible}		</if>		<if test="amounts !=null and amounts !=''">			,#{amounts}		</if>		<if test="premiums !=null and premiums !=''">			,#{premiums}		</if>		<if test="appointment !=null and appointment !=''">			,#{appointment}		</if>		<if test="introduce !=null and introduce !=''">			,#{introduce}		</if>		<if test="insuranceClause !=null and insuranceClause !=''">			,#{insuranceClause}		</if>		<if test="name!=null and name!=''">			,#{name}		</if>		<if test="remark!=null and remark!=''">			,#{remark}		</if>		)	</insert>	<!--插入子产品信息 -->	<insert id="manage.secureProduct.insertSecureProductDetail"		parameterType="net.jeeshop.services.manage.secureProduct.bean.SecureProductDetail"		useGeneratedKeys="true" keyProperty="id">		insert into t_secureProductDetail		(		pid,subName,amount,sure_way,rate		,premium,deleteFlag		,status,createAccount,createTime		<if test="remark!=null and remark!=''">			,remark		</if>		)		values		(		#{pid},#{subName},#{amount},#{sure_way},#{rate}		,#{premium},#{deleteFlag}		,#{status},#{createAccount},now()		<if test="remark!=null and remark!=''">			,#{remark}		</if>		)	</insert>	<!--更新产品信息 -->	<update id="manage.secureProduct.update"		parameterType="net.jeeshop.services.manage.secureProduct.bean.SecureProduct">		update t_secureProduct		set		updatetime=now(),updateAccount=#{updateAccount}		<if test="currency !=null and currency !=''">			,currency=#{currency}		</if>		<if test="deductible !=null and deductible !=''">			,deductible=#{deductible}		</if>		<if test="status !=null and status !=''">			,status=#{status}		</if>		<if test="amounts !=null and amounts !=''">			,amounts=#{amounts}		</if>		<if test="premiums !=null and premiums !=''">			,premiums=#{premiums}		</if>		<if test="appointment !=null and appointment !=''">			,appointment=#{appointment}		</if>		<if test="introduce !=null and introduce !=''">			,introduce=#{introduce}		</if>		<if test="insuranceClause !=null and insuranceClause !=''">			,insuranceClause=#{insuranceClause}		</if>		<if test="name !=null and name !=''">			,name=#{name}		</if>		<if test="remark !=null and remark!=''">			,remark=#{remark}		</if>		where 1=1		<if test="id !=null and id!=''">			and id=#{id}		</if>	</update>	<!--更新子产品信息 -->	<update id="manage.secureProduct.updateSecureProductDetail"		parameterType="net.jeeshop.services.manage.secureProduct.bean.SecureProductDetail">		update t_secureProduct		set		updatetime=now(),updateAccount=#{updateAccount}		<if test="pId !=null and pId!=''">			,pId=#{pId}		</if>		<if test="subName !=null and subName !=''">			,subName=#{subName}		</if>		<if test="amount !=null and amount !=''">			,amount=#{amount}		</if>		<if test="sure_way !=null and sure_way !=''">			,sure_way=#{sure_way}		</if>		<if test="rate !=null and rate !=''">			,rate=#{rate}		</if>		<if test="premium !=null and premium !=''">			,premium=#{premium}		</if>		<if test="remark !=null and remark!=''">			,remark=#{remark}		</if>		where 1=1		<if test="id !=null and id!=''">			and id=#{id}		</if>	</update>	<!--删除主产品调用，只是修改标志位 -->	<delete id="manage.secureProduct.delete" parameterType="int">		update		t_secureProduct set deleteFlag=1 where id=#{id}	</delete>	<!--删除子产品调用，只是修改标志位 -->	<delete id="manage.secureProduct.deleteSubProduct" parameterType="net.jeeshop.services.manage.secureProduct.bean.SecureProductDetail">		update		t_secureProductDetail set deleteFlag=1,updateAccount=#{updateAccount} where pId=#{pid}	</delete>	<!--上架或者下架调用 -->	<update id="manage.secureProduct.updateProductStatus"		parameterType="net.jeeshop.services.manage.secureProduct.bean.SecureProduct">		update t_secureProduct set		updatetime=now(),updateAccount=#{updateAccount},status=#{status} where		1=1		<if test="id !=null and id!=''">			and id=#{id}		</if>	</update>	<update id="manage.secureProduct.updateSubProductStatus"		parameterType="net.jeeshop.services.manage.secureProduct.bean.SecureProductDetail">		update t_secureProductDetail set		updatetime=now(),updateAccount=#{updateAccount},status=#{status} where		1=1		<if test="pid !=null and pid!=''">			and pId=#{pid}		</if>	</update>	<!-- 删除用户产品 -->	<delete id="manage.secureProduct.deleteUsersProduct"		parameterType="string">		delete from t_user_product where user_id=#{uid}	</delete>	<!-- 添加用户产品 -->	<insert id="manage.secureProduct.insertUsersProduct"		parameterType="net.jeeshop.services.common.userProduct">		insert into t_user_product(id,user_id,product_id)		values(#{id},#{uid},#{pid})	</insert>	<!-- 根据用户获取该用户下的所有产品 -->	<select id="manage.secureProduct.getAllProductsByUserId"		parameterType="int"		resultType="net.jeeshop.services.manage.secureProduct.bean.SecureProduct">		select b.* from t_user_product u,t_secureproduct b where		u.user_id=#{uid} and		b.id=u.product_id and b.deleteFlag='0' and status=1		order by		createtime 	desc	</select>	<!-- 获取所有产品列表 -->	<select id="manage.secureProduct.getAllProducts" parameterType="string"		resultType="net.jeeshop.services.manage.secureProduct.bean.SecureProduct">		select * from t_secureproduct b where b.deleteFlag='0'		<if test="_parameter != null">			and name like CONCAT('%',#{_parameter,jdbcType=VARCHAR}			,'%' )		</if>		order by createtime desc	</select></mapper>