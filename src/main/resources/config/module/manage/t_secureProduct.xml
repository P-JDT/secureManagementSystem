<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd"><!-- create by autoCode,v1.0.0 --><mapper namespace="manage.secureProduct">	<!--查询保险产品信息 -->	<select id="manage.secureProduct.selectPageList"		parameterType="net.jeeshop.services.manage.secureProduct.bean.SecureProduct"		resultType="net.jeeshop.services.manage.secureProduct.bean.SecureProduct">		select		p.id,p.CProdNo,p.CProdName,p.NAmtRmbExch,p.NAmt,p.NPrmRmbExch,p.NPrm				,DATE_FORMAT(p.createtime,'%Y-%m-%d') createtime		,p.introduce,p.insuranceClause,p.status from		t_secureProduct p where 1=1 and deleteFlag=0		<if test="CProdNo !=null and CProdNo !=''">			and p.CProdNo like CONCAT('%','${CProdNo}','%' )		</if>				<if test="uid!=null and uid!=''">			and p.id in (select product_id from t_user_product where			user_id=			#{uid})		</if>		<if test="status!=null and status!=''">			and status=#{status}		</if>		<if test="CProdName !=null and CProdName !=''">			and p.CProdName like CONCAT('%','${CProdName}','%' )		</if> 		<if test="startDate!=null and startDate!=''">			and createtime &gt;= #{startDate}	 	</if>	 	<if test="endDate!=null and endDate!=''">			and createtime &lt;= #{endDate}	 	</if>			order by p.createtime desc			limit #{offset},#{pageSize}	</select>	<!--按照id查询保险产品信息 -->	<select id="manage.secureProduct.selectById" parameterType="string"		resultType="net.jeeshop.services.manage.secureProduct.bean.SecureProduct">		select * from t_secureProduct where		1=1 and id=#{id}	</select>	<!--查询保险子产品信息 -->	<select id="manage.secureProduct.selectDetail" parameterType="string"		resultType="net.jeeshop.services.manage.secureProduct.bean.SecureProductDetail">		select * from t_secureProductDetail where		1=1 and deleteFlag=0 		<if test="pId !=null and pId !=''">		and pId=#{pId}		</if>	</select>	<!--查询ids -->	<select id="manage.secureProduct.selectIDList" parameterType="net.jeeshop.services.common.userProduct"		resultType="net.jeeshop.services.common.userProduct">		select * from t_user_product where		1=1		<if test="user_id !=null and user_id!=''">			and user_id=#{user_id}		</if> 	</select>		<!--查询产品总数 -->	<select id="manage.secureProduct.selectPageCount"		parameterType="net.jeeshop.services.manage.secureProduct.bean.SecureProduct"		resultType="java.lang.Integer">		select count(*) from t_secureProduct p where 1=1 and deleteFlag=0		<if test="CProdNo !=null and CProdNo !=''">			and p.CProdNo like CONCAT('%','${CProdNo}','%' )		</if>				<if test="uid!=null and uid!=''">			and p.id in (select product_id from t_user_product where			user_id=			#{uid})		</if>		<if test="status!=null and status!=''">			and status=#{status}		</if>		<if test="CProdName !=null and  CProdName !=''">			and p.CProdName like CONCAT('%','${CProdName}','%' )		</if> 		<if test="startDate!=null and startDate!=''">		and createtime &gt;= #{startDate}	 	</if>	 	<if test="endDate!=null and endDate!=''">		and createtime &lt;= #{endDate}	 	</if>	</select>	<!--插入产品信息 -->	<insert id="manage.secureProduct.insertSecureProduct"		parameterType="net.jeeshop.services.manage.secureProduct.bean.SecureProduct"		useGeneratedKeys="true" keyProperty="id">		insert into t_secureProduct		(		status,deleteFlag		,createAccount,createTime		<if test="CProdNo !=null and CProdNo !=''">			,CProdNo		</if>		<if test="CProdName !=null and CProdName !=''">			,CProdName		</if>		<if test="NAmtRmbExch !=null and NAmtRmbExch !=''">			,NAmtRmbExch		</if>		<if test="NAmt !=null and NAmt !=''">			,NAmt		</if>		<if test="NPrmRmbExch !=null and NPrmRmbExch !=''">			,NPrmRmbExch		</if>		<if test="NPrm !=null and NPrm !=''">			,NPrm		</if>		<if test="introduce !=null and introduce !=''">			,introduce		</if>		<if test="insuranceClause !=null and insuranceClause !=''">			,insuranceClause		</if>		)		values		(		#{status},0		,#{createAccount},now()		<if test="CProdNo !=null and CProdNo !=''">			,#{CProdNo}		</if>		<if test="CProdName !=null and CProdName !=''">			,#{CProdName}		</if>		<if test="NAmtRmbExch !=null and NAmtRmbExch !=''">			,#{NAmtRmbExch}		</if>		<if test="NAmt !=null and NAmt !=''">			,#{NAmt}		</if>		<if test="NPrmRmbExch !=null and NPrmRmbExch !=''">			,#{NPrmRmbExch}		</if>		<if test="NPrm !=null and NPrm !=''">			,#{NPrm}		</if>		<if test="introduce !=null and introduce !=''">			,#{introduce}		</if>		<if test="insuranceClause !=null and insuranceClause !=''">			,#{insuranceClause}		</if>		)	</insert>	<!--插入子产品信息 -->	<insert id="manage.secureProduct.insertSecureProductDetail"		parameterType="net.jeeshop.services.manage.secureProduct.bean.SecureProductDetail"		useGeneratedKeys="true" keyProperty="id">		insert into t_secureProductDetail		(		pId,subName,deleteFlag,status,createAccount,createTime		<if test="amount !=null and amount !=''">			,amount		</if>		<if test="sure_way !=null and sure_way !=''">			,sure_way		</if>		<if test="rate !=null and rate !=''">			,rate		</if>		<if test="premium !=null and premium !=''">			,premium		</if>		<if test="remark!=null and remark!=''">			,remark		</if>		)		values		(		#{pId},#{subName},#{deleteFlag},#{status},#{createAccount},now()		<if test="amount !=null and amount !=''">			,#{amount}		</if>		<if test="sure_way !=null and sure_way !=''">			,#{sure_way}		</if>		<if test="rate !=null and rate !=''">			,#{rate}		</if>		<if test="premium !=null and premium !=''">			,#{premium}		</if>		<if test="remark!=null and remark!=''">			,#{remark}		</if>		)	</insert>	<!--更新产品信息 -->	<update id="manage.secureProduct.update"		parameterType="net.jeeshop.services.manage.secureProduct.bean.SecureProduct">		update t_secureProduct		set		updatetime=now(),updateAccount=#{updateAccount}		<if test="CProdNo !=null and CProdNo !=''">			,CProdNo=#{CProdNo}		</if>		<if test="CProdName !=null and CProdName !=''">			,CProdName=#{CProdName}		</if>		<if test="NAmtRmbExch !=null and NAmtRmbExch !=''">			,NAmtRmbExch=#{NAmtRmbExch}		</if>		<if test="NAmt !=null and NAmt !=''">			,NAmt=#{NAmt}		</if>		<if test="NPrmRmbExch !=null and NPrmRmbExch !=''">			,NPrmRmbExch=#{NPrmRmbExch}		</if>		<if test="NPrm !=null and NPrm !=''">			,NPrm=#{NPrm}		</if>		<if test="introduce !=null and introduce !=''">			,introduce=#{introduce}		</if>		<if test="insuranceClause !=null and insuranceClause !=''">			,insuranceClause=#{insuranceClause}		</if>		where 1=1		<if test="id !=null and id !=''">			and id=#{id}		</if>	</update>	<!--更新子产品信息 -->	<update id="manage.secureProduct.updateSecureProductDetail"		parameterType="net.jeeshop.services.manage.secureProduct.bean.SecureProductDetail">		update t_secureProductDetail		set		updatetime=now(),updateAccount=#{updateAccount}		<if test="subName !=null and subName !=''">			,subName=#{subName}		</if>		<if test="amount !=null and amount !=''">			,amount=#{amount}		</if>		<if test="sure_way !=null and sure_way !=''">			,sure_way=#{sure_way}		</if>		<if test="rate !=null and rate !=''">			,rate=#{rate}		</if>		<if test="premium !=null and premium !=''">			,premium=#{premium}		</if>		<if test="remark !=null and remark!=''">			,remark=#{remark}		</if>		where 1=1		<if test="id !=null and id!=''">			and id=#{id}		</if>		<if test="pId !=null and pId!=''">			and pId=#{pId}		</if>	</update>	<!--删除主产品调用，只是修改标志位 -->	<delete id="manage.secureProduct.delete" parameterType="int">		update		t_secureProduct set deleteFlag=1 where id=#{id}	</delete>	<!--删除子产品调用，只是修改标志位 -->	<delete id="manage.secureProduct.deleteSubProduct" parameterType="net.jeeshop.services.manage.secureProduct.bean.SecureProductDetail">		update		t_secureProductDetail set deleteFlag=1,updateAccount=#{updateAccount} where 1=1		<if test="id !=null and id !=''">			and id=#{id}		</if>		<if test="pId !=null and pId !=''">			and pId=#{pId}		</if>			</delete>	<!--上架或者下架调用 -->	<update id="manage.secureProduct.updateProductStatus"		parameterType="net.jeeshop.services.manage.secureProduct.bean.SecureProduct">		update t_secureProduct set		updatetime=now(),updateAccount=#{updateAccount},status=#{status} where		1=1		<if test="id !=null and id!=''">			and id=#{id}		</if>	</update>	<update id="manage.secureProduct.updateSubProductStatus"		parameterType="net.jeeshop.services.manage.secureProduct.bean.SecureProductDetail">		update t_secureProductDetail set		updatetime=now(),updateAccount=#{updateAccount},status=#{status} where		1=1		<if test="pId !=null and pId!=''">			and pId=#{pId}		</if>	</update>	<!-- 删除用户产品 -->	<delete id="manage.secureProduct.deleteUsersProduct"		parameterType="string">		delete from t_user_product where user_id=#{uid}	</delete>	<!-- 添加用户产品 -->	<insert id="manage.secureProduct.insertUsersProduct"		parameterType="net.jeeshop.services.common.userProduct">		insert into t_user_product(id,user_id,product_id)		values(#{id},#{user_id},#{product_id})	</insert>	<!-- 根据用户获取该用户下的所有产品 -->	<select id="manage.secureProduct.getAllProductsByUserId"		parameterType="int"		resultType="net.jeeshop.services.manage.secureProduct.bean.SecureProduct">		select b.* from t_user_product u,t_secureproduct b where		u.user_id=#{uid} and		b.id=u.product_id and b.deleteFlag='0' 		<!-- and status=1 已上架 -->		order by		createtime 	desc		limit #{offset},#{pageSize}	</select>		<select id="manage.secureProduct.getProductsByUserIdPageCount"		parameterType="net.jeeshop.services.manage.secureProduct.bean.SecureProduct"		resultType="java.lang.Integer">		select count(*) from t_user_product u,t_secureproduct b where		b.id = u.product_id and b.deleteFlag='0' 		<if test="uid!=null and uid!=''">		and u.user_id = #{uid}		</if>	</select>		<select id="manage.secureProduct.selectOne"		parameterType="net.jeeshop.services.manage.secureProduct.bean.SecureProduct"		resultType="net.jeeshop.services.manage.secureProduct.bean.SecureProduct">		select * from t_secureProduct p where 1=1 		<if test="CProdNo !=null and CProdNo !=''">			and CProdNo=#{CProdNo}		</if>			<if test="CProdName !=null and CProdName !=''">			and CProdName=#{CProdName}		</if>			<if test="deleteFlag !=null and deleteFlag !=''">			and deleteFlag=#{deleteFlag}		</if>			</select></mapper>